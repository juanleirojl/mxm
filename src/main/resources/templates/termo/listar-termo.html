<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head th:replace="~{layout :: head('Orçamentos')}"></head>

<body>
	<div class="wrapper">
		<aside th:replace="~{fragments/sidebar :: sidebar}"></aside>
		<div class="main-panel">
			<div th:replace="~{fragments/navbar :: navbar}"></div>
			<div class="container">
				<div class="page-inner">
					<div class="d-flex align-items-left align-items-md-center flex-column flex-md-row pt-2 pb-4">
						<div>
							<h3 class="fw-bold mb-3">Listar termos</h3>
						</div>
						<div class="ms-md-auto py-2 py-md-0">
							<a th:href="@{/termo}" class="btn btn-primary btn-round">Gerar Termo</a>
						</div>
					</div>


					<div class="row">
						<div class="col-md-12">
							<div class="card">
								<div class="card-header">
									<h4 class="card-title">Termo Carregamento </h4>
								</div>
								<div class="card-body">
									<div class="table-responsive">
										<table id="basic-datatables" class="display table table-striped table-hover">
											<thead>
										        <tr>
										            <th>Motorista</th>
										            <th>Placa</th>
										            <th>Data</th>
										            <th>Ação</th>
										        </tr>
										    </thead>
											<tbody>
												<tr th:each="termo : ${termos}" th:with="dataFormatada=${#temporals.format(termo.dataCadastro, 'dd/MM/yyyy HH:mm')}">
										            <td th:text="${termo.motorista}"></td>
										            <td th:text="${termo.placa}"></td>
													<td th:text="${dataFormatada}"></td>
										            <td>
										                <a th:href="@{'/termo/download/' + ${termo.id}}">Baixar Arquivo</a>
										            </td>
										        </tr>
						                    </tbody>
										</table>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
				<footer th:replace="~{layout :: footer}"></footer>
			</div>
		</div>
		<div th:replace="~{fragments/scripts :: scripts}"></div>
		
		<script>
		      $(document).ready(function () {
		        $("#basic-datatables").DataTable({});

		        $("#multi-filter-select").DataTable({
		          pageLength: 5,
		          initComplete: function () {
		            this.api()
		              .columns()
		              .every(function () {
		                var column = this;
		                var select = $(
		                  '<select class="form-select"><option value=""></option></select>'
		                )
		                  .appendTo($(column.footer()).empty())
		                  .on("change", function () {
		                    var val = $.fn.dataTable.util.escapeRegex($(this).val());

		                    column
		                      .search(val ? "^" + val + "$" : "", true, false)
		                      .draw();
		                  });

		                column
		                  .data()
		                  .unique()
		                  .sort()
		                  .each(function (d, j) {
		                    select.append(
		                      '<option value="' + d + '">' + d + "</option>"
		                    );
		                  });
		              });
		          },
		        });

		        // Add Row
		        $("#add-row").DataTable({
		          pageLength: 5,
		        });

		        var action =
		          '<td> <div class="form-button-action"> <button type="button" data-bs-toggle="tooltip" title="" class="btn btn-link btn-primary btn-lg" data-original-title="Edit Task"> <i class="fa fa-edit"></i> </button> <button type="button" data-bs-toggle="tooltip" title="" class="btn btn-link btn-danger" data-original-title="Remove"> <i class="fa fa-times"></i> </button> </div> </td>';

		        $("#addRowButton").click(function () {
		          $("#add-row")
		            .dataTable()
		            .fnAddData([
		              $("#addName").val(),
		              $("#addPosition").val(),
		              $("#addOffice").val(),
		              action,
		            ]);
		          $("#addRowModal").modal("hide");
		        });
				$("#basic-datatables").DataTable({
				      ordering: true, // Ativa a ordenação
				      order: [[2, "desc"]], // Ordena pela coluna "Data" (índice 2), em ordem decrescente
				    });		
		      });
		    </script>
</body>

</html>